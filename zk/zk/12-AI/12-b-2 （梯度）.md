### 链式法则[^2]

然而，上面方法可能很难找到梯度。 这是因为在深度学习中，多元函数通常是_复合_（composite）的， 所以难以应用上述任何规则来微分这些函数。 幸运的是，链式法则可以被用来微分复合函数。

让我们先考虑单变量函数。假设函数y=f(u)和u=g(x)都是可微的，根据链式法则有：
$$
\frac{dy}{dx} = \frac{dy}{du} \frac{du}{dx}.
$$


现在考虑一个更一般的场景，即函数具有任意数量的变量的情况。 假设可微分函数$y$有变量$u_1,u_2...u_m$，其中每个可微分函数$u_i$都有变量$x_1...x_n$。

则注意，$y$是$x_1...x_n$的函数。对于任意$i=1,2...n$，链式法则有：

$$
\frac{\partial y}{\partial x_i} = \frac{\partial y}{\partial u_1} \frac{\partial u_1}{\partial x_i} + \frac{\partial y}{\partial u_2} \frac{\partial u_2}{\partial x_i} + \cdots + \frac{\partial y}{\partial u_m} \frac{\partial u_m}{\partial x_i}
$$

![](../../../files/images/AI/12-b-2-2.png)
 

[^1]: https://zh-v2.d2l.ai/chapter_preliminaries/calculus.html#subsec-calculus-grad

[^2]: https://zh-v2.d2l.ai/chapter_preliminaries/calculus.html#id5

